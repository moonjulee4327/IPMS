<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace : xml파일은 여러개일 수 있음.
이를 구별하기 위한 식별 용도로 사용 -->
<mapper namespace="com.ipms.main.newProject.mapper.ProjMapper">


    <select id="listProj"  resultType="com.ipms.main.newProject.vo.ProjVO">
        SELECT PROJ_NAME
             , PROJ_SMRY
        FROM PROJ
    </select>




    <!--프로젝트 생성 com.ipms.main.newProject.mapper.ProjMapper.projInsert-->
    <insert id="projInsert" parameterType="com.ipms.main.newProject.vo.ProjVO">
        <selectKey order="BEFORE" keyProperty="projId" resultType="String">
            SELECT To_char(NVL(MAX(proj_id),0)+1) FROM proj
        </selectKey>
        INSERT INTO proj (
        proj_id,
        mem_code,
        proj_name,
        proj_strt_date,
        proj_end_date,
        proj_smry,
        proj_opn_whth,
        proj_creatn_date,
        proj_img_route,
        delete_whth
        ) VALUES (
        #{projId},
        (select mem_code from mem where mem_email =#{memEmail}),
        #{projName},
        #{projStrtDate},
        #{projEndDate},
        #{projSmry},
        'Y',
        sysdate,
        '/',
        '0'
        )
    </insert>


    <insert id="insertProjMem" parameterType="com.ipms.main.newProject.vo.ProjMemVO">
        insert into proj_mem(
        MEM_CODE
        , proj_id

        , PRTPT_APROV_CODE
        , REFER_CTS
        )
        values (
        #{memCode}
        ,#{projId}
       <!--teamId-->
        , 'Y'
        , '0'
        )
    </insert>




</mapper>








        <!--    <update id="insertProjMem" parameterType="java.util.List">-->
        <!--        <foreach collection="list" item="mem" open="INSERT ALL "-->
        <!--                 close="SELECT * FROM SYS.DUAL" separator=" ">-->
        <!--            INTO proj_mem VALUES-->
        <!--            (-->
        <!--&lt;!&ndash;            (select mem_code from mem where mem_email =#{memEmail}) &lt;!&ndash;memCode &ndash;&gt;&ndash;&gt;-->
        <!--&lt;!&ndash;            ,(select proj_id from proj where proj_id='2' and mem_code =  (select mem_code from mem where mem_email =#{memEmail}))&lt;!&ndash;projId &ndash;&gt;&ndash;&gt;-->
        <!--            #{mem.memCode}-->
        <!--            ,#{mem.projId}-->
        <!--            ,'3'-->
        <!--            ,'N'-->
        <!--            ,'0'-->
        <!--            )-->
        <!--        </foreach>-->
        <!--    </update>-->